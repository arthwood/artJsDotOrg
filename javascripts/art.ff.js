var com = {arthwood: {data: {},dom: {},events: {},math: {},modules: {},net: {},tween: {},ui: {containers: {}},utils: {}}};var ArtJs = {VERSION: '1.0',CLIENT: 'Mozilla',globalize: function() {var copy = this.ObjectUtils.copy(this);delete copy.globalize;delete copy.doInjection;delete copy.VERSION;delete copy.CLIENT;this.ObjectUtils.copyProps(copy, window);},doInjection: function() {this.ArrayUtils.doInjection();this.ObjectUtils.doInjection();this.StringUtils.doInjection();this.DateUtils.doInjection();this.Selector.doInjection();this.ElementUtils.doInjection();this.EventUtils.doInjection();this.Delegate.doInjection();com.arthwood.tween.Reveal.doInjection();com.arthwood.tween.Fade.doInjection();}};
ArtJs.p = window.console ? window.console.debug : alert;
ArtJs.Delegate = com.arthwood.events.Delegate = function(object, method) {this.object = object;this.method = method;this.args = ArtJs.$A(arguments, 2);};ArtJs.Delegate.prototype = {invoke: function() {var args = ArtJs.$A(arguments).concat(this.args);return this.method.apply(this.object, args);},callback: function(withSource) {var result = function() {var callee = arguments.callee;var delegate = callee.delegate;var args = ArtJs.$A(arguments);callee.withSource && args.unshift(this);return delegate.invoke.apply(delegate, args);};result.withSource = withSource;result.delegate = this;return result;}};ArtJs.$DC = ArtJs.Delegate.callback = function(object, method, withSource) {var delegate = new ArtJs.Delegate(object, method);var callback = delegate.callback(withSource);delegate.args = ArtJs.$A(arguments, 3);return callback;};ArtJs.$D = ArtJs.Delegate.create = function(object, method) {var delegate = new ArtJs.Delegate(object, method);delegate.args = ArtJs.$A(arguments, 2);return delegate;};ArtJs.Delegate.injected = false;ArtJs.Delegate.doInjection = function() {Function.prototype.bind = function(obj, withSource) {return ArtJs.$DC.apply(ArtJs.$DC, [obj, this, withSource].concat(ArtJs.$A(arguments, 2)));};ArtJs.Delegate.injected = true;};
ArtJs.MathUtils = com.arthwood.utils.MathUtils = {sgn: function(x) {return x == 0 ? 0 : Math.abs(x) / x;},limit: function(x, a, b) {return Math.min(Math.max(x, a), b);},periodicLimit: function(x, a, b) {return x - this.stairs(x, a, b) * (b - a);},stairs: function(x, a, b) {return Math.floor((x - a) / (b - a));}};
ArtJs.ObjectUtils = com.arthwood.utils.ObjectUtils = {QUERY_DELIMITER: '&',init: function() {this.invertedRemoveValueDelegate = ArtJs.$DC(this, this.invertedRemoveValue);this.eachPairDeleteValueDelegate = ArtJs.$DC(this, this.eachPairDeleteValue);this.keyValueArrayDelegate = ArtJs.$DC(this, this.keyValueArray);this.pairToQueryStringDelegate = ArtJs.$DC(this, this.pairToQueryString);this.parseArrayValueDelegate = ArtJs.$DC(this, this.parseArrayValue);this.invertedIncludeDC = ArtJs.$DC(this, this.invertedInclude);},copy: function(obj) {var copy = new Object();this.copyProps(obj, copy);return copy;},copyProps: function(from, to) {for (var i in from) {to[i] = from[i];}},extend: function(obj, withObj) {this.copyProps(withObj, obj)},merge: function(obj, withObj) {this.extend(obj, withObj);return obj;},removeValue: function(obj, val) {this.eachPairDeleteValueDelegate.delegate.args = [obj, val];this.eachPair(obj, this.eachPairDeleteValueDelegate);},eachPairDeleteValue: function(i, j, obj, val) {if (j === val) {delete obj[i];}},invertedRemoveValue: function(val, obj) {this.removeValue(obj, val);},removeValues: function(obj, values) {this.invertedRemoveValueDelegate.delegate.args = [obj];ArtJs.ArrayUtils.each(values, this.invertedRemoveValueDelegate);},map: function(obj, func) {var result = new Array();for (var i in obj) {if (obj.hasOwnProperty(i)) {result.push(func(i, obj[i]));}}return result;},mapValue: function(obj, func) {var result = new Object();for (var i in obj) {if (obj.hasOwnProperty(i)) {result[i] = func(obj[i]);}}return result;},mapKey: function(obj, func) {var result = new Object();for (var i in obj) {if (obj.hasOwnProperty(i)) {result[func(i)] = obj[i];}}return result;},each: function(obj, func) {for (var i in obj) {if (obj.hasOwnProperty(i)) {func(obj[i]);}}},eachKey: function(obj, func) {for (var i in obj) {if (obj.hasOwnProperty(i)) {func(i);}}},eachPair: function(obj, func) {for (var i in obj) {if (obj.hasOwnProperty(i)) {func(i, obj[i]);}}},select: function(obj, func) {var result = new Object();this.eachPair(obj, function(i, j) {if (func(j)) {result[i] = j;}});return result;},selectWithKey: function(obj, func) {var result = new Object();this.eachPair(obj, function(i, j) {if (func(i, j)) {result[i] = j;}});return result;},reject: function(obj, func) {var result = new Object();this.eachPair(obj, function(i, j) {if (!func(j)) {result[i] = j;}});return result;},empty: function(obj) {for (var i in obj) {if (obj.hasOwnProperty(i)) {return false;}}return true;},fromArray: function(arr) {var result = new Object();var item;for (var i in arr) {if (arr.hasOwnProperty(i)) {item = arr[i];result[item[0]] = item[1];}}return result;},toArray: function(obj) {return this.map(obj, this.keyValueArrayDelegate);},keyValueArray: function(key, value) {return [key, value];},invertedInclude: function(item, obj) {return this.include(obj, item);},include: function(obj, item) {for (var i in obj) {if (obj.hasOwnProperty(i) && obj[i] === item) {return true;}}return false;},includeAll: function(obj, subset) {this.invertedIncludeDC.delegate.args = [obj];return this.all(subset, this.invertedIncludeDC);},all: function(obj, func) {for (var i in obj) {if (obj.hasOwnProperty(i) && !func(obj[i])) {return false;}}return true;},toQueryString: function(obj) {return this.toQueryStringWithPrefix(obj, '');},toQueryStringWithPrefix: function(obj, prefix) {var delegate = ArtJs.$DC(this, this.pairToQueryString, false, prefix);return this.map(obj, delegate).join(this.QUERY_DELIMITER);},pairToQueryString: function(key, value, prefix) {var result;prefix = ArtJs.StringUtils.blank(prefix) ? key : prefix + '[' + key + ']';if (typeof value == 'object') {if (isNaN(value.length)) {result = this.toQueryStringWithPrefix(value, prefix)}else {var delegate = ArtJs.$DC(this, this.parseArrayValue, false, prefix + '[]');result = ArtJs.ArrayUtils.map(value, delegate).join(this.QUERY_DELIMITER);}}else {result = prefix + '=' + encodeURIComponent(this.primitiveToQueryString(value));}return result;},parseArrayValue: function(value, idx, prefix) {return this.pairToQueryString(prefix, value);},primitiveToQueryString: function(obj) {var result;switch (typeof obj) {case 'number':result = obj.toString();break;case 'boolean':result = Number(obj).toString();break;default:result = obj;}return result;},doInjection: function() {var proto = Object.prototype;var dc = ArtJs.$DC;proto.copy = dc(this, this.copy, true);proto.copyProps = dc(this, this.copyProps, true);proto.extend = dc(this, this.extend, true);proto.merge = dc(this, this.merge, true);proto.removeValue = dc(this, this.removeValue, true);proto.removeValues = dc(this, this.removeValues, true);proto.map = dc(this, this.map, true);proto.mapKey = dc(this, this.mapKey, true);proto.mapValue = dc(this, this.mapValue, true);proto.each = dc(this, this.each, true);proto.eachPair = dc(this, this.eachPair, true);proto.select = dc(this, this.select, true);proto.selectWithKey = dc(this, this.selectWithKey, true);proto.reject = dc(this, this.reject, true);proto.empty = dc(this, this.empty, true);proto.toArray = dc(this, this.toArray, true);proto.include = dc(this, this.include, true);proto.includeAll = dc(this, this.includeAll, true);proto.all = dc(this, this.all, true);proto.toQueryString = dc(this, this.toQueryString, true);}};
ArtJs.ArrayUtils = com.arthwood.utils.ArrayUtils = {init: function() {this.intersectionSelectDC = ArtJs.$DC(this, this.intersectionSelect);this.includeDC = ArtJs.$DC(this, this.include);this.invertedIncludeDC = ArtJs.$DC(this, this.invertedInclude);this.nonEmptyDC = ArtJs.$DC(this, this.nonEmpty);this.notNullDC = ArtJs.$DC(this, this.notNull);},build: function(n, func) {var arr = new Array(n);for (var i = 0; i < n; i++) {arr[i] = func(i);}return arr;},first: function(arr) {return this.getItem(arr, 0);},second: function(arr) {return this.getItem(arr, 1);},third: function(arr) {return this.getItem(arr, 2);},last: function(arr) {return this.getItem(arr, arr.length - 1);},beforeLast: function(arr) {return this.getItem(arr, arr.length - 2);},getItem: function(arr, i) {return arr[i];},invertedInclude: function(item, arr) {return this.include(arr, item);},include: function(arr, item) {return Boolean(arr.indexOf(item) + 1);},includeAll: function(arr, subset) {this.invertedIncludeDC.delegate.args = [arr];return this.all(subset, this.invertedIncludeDC);},insertAt: function(arr, idx, insertion) {return arr.slice(0, idx).concat(insertion).concat(arr.slice(idx));},removeAt: function(arr, idx) {return arr.splice(idx, 1);},removeItem: function(arr, item, onlyFirst) {var n = arr.length;while (n-- > 0) {if (arr[n] === item) {arr.splice(n, 1);if (onlyFirst) return;}}},arrify: function(v, idx) {var args = new Array();var n = v.length;for (var i = idx || 0; i < n; i++) {args.push(v[i]);}return args;},map: function(arr, func) {var result = new Array();for (var i in arr) {if (arr.hasOwnProperty(i)) {result.push(func(arr[i], parseInt(i)));}}return result;},each: function(arr, func) {for (var i in arr) {if (arr.hasOwnProperty(i)) {func(arr[i]);}}},eachIndex: function(arr, func) {for (var i in arr) {if (arr.hasOwnProperty(i)) {func(parseInt(i));}}},eachPair: function(arr, func) {for (var i in arr) {if (arr.hasOwnProperty(i)) {func(parseInt(i), arr[i]);}}},inject: function(arr, init, func) {var vResult = init;for (var i in arr) {if (arr.hasOwnProperty(i)) {vResult = func(vResult, arr[i], i);}}return vResult;},flatten: function(arr) {return this.inject(arr, [], this.flattenCallback);},flattenCallback: function(mem, i) {return mem.concat(i);},select: function(arr, func) {var vResult = new Array();this.each(arr, function(i) {if (func(i)) vResult.push(i);});return vResult;},reject: function(arr, func) {var vResult = new Array();this.each(arr, function(i) {if (!func(i)) vResult.push(i);});return vResult;},$reject: function(arr, func) {var n = arr.length - 1;for (var i = n; i >= 0; i--) {if (func(arr[i])) arr.splice(i, 1);}},detect: function(arr, func) {for (var i in arr) {if (arr.hasOwnProperty(i) && func(arr[i])) {return arr[i];}}return null;},all: function(arr, func) {for (var i in arr) {if (arr.hasOwnProperty(i) && !func(arr[i])) {return false;}}return true;},any: function (arr, func) {for (var i in arr) {if (arr.hasOwnProperty(i) && func(arr[i])) {return true;}}return false;},partition: function(arr, func) {var point = new ArtJs.Point([], []);var item;for (var i in arr) {arr.hasOwnProperty(i) && (item = arr[i]) && (func(item, i) ? point.x : point.y).push(item);}return point;},uniq: function(arr, func) {var comparison = func || this.uniqDefault;var copy = arr.concat();var result = new Array();var item, n;while (n = copy.length) {item = copy[0];result.push(item);while (n-- > 0) {if (comparison(copy[n], item)) {copy.splice(n, 1);}}}return result;},uniqDefault: function(i, j) {return i === j;},intersection: function(arr) {this.commonTestArray = arr.slice(1);return this.select(arr[0], this.intersectionSelectDC);},intersectionSelect: function(i) {this.includeDC.delegate.args = [i];return this.all(this.commonTestArray, this.includeDC);},selectNonEmpty: function(arr) {return this.select(arr, this.nonEmptyDC);},compact: function(arr) {return this.select(arr, this.notNullDC);},notNull: function(i) {return !isNaN(i) || Boolean(i);},empty: function(arr) {return arr.length == 0;},nonEmpty: function(arr) {return !this.empty(arr);},numerize: function(arr) {return this.map(arr, this.numerizeCallback);},numerizeCallback: function (i) {return Number(i);},sum: function(arr) {return Number(this.inject(arr, 0, this.sumCallback));},sumCallback: function(sum, i) {return sum + i;},stringify: function(arr) {return this.map(arr, this.stringifyCallback);},stringifyCallback: function(i) {return i.toString();},print: function(arr) {this.each(arr, p);},doInjection: function() {var proto = Array.prototype;var dc = ArtJs.$DC;proto.first = dc(this, this.first, true);proto.second = dc(this, this.second, true);proto.third = dc(this, this.third, true);proto.beforeLast = dc(this, this.beforeLast, true);proto.last = dc(this, this.last, true);proto.getItem = dc(this, this.getItem, true);proto.include = dc(this, this.include, true);proto.includeAll = dc(this, this.includeAll, true);proto.insertAt = dc(this, this.insertAt, true);proto.removeAt = dc(this, this.removeAt, true);proto.removeItem = dc(this, this.removeItem, true);proto.map = dc(this, this.map, true);proto.each = dc(this, this.each, true);proto.eachIndex = dc(this, this.eachIndex, true);proto.eachPair = dc(this, this.eachPair, true);proto.inject = dc(this, this.inject, true);proto.flatten = dc(this, this.flatten, true);proto.select = dc(this, this.select, true);proto.reject = dc(this, this.reject, true);proto.$reject = dc(this, this.$reject, true);proto.detect = dc(this, this.detect, true);proto.all = dc(this, this.all, true);proto.any = dc(this, this.any, true);proto.partition = dc(this, this.partition, true);proto.uniq = dc(this, this.uniq, true);proto.intersection = dc(this, this.intersection, true);proto.selectNonEmpty = dc(this, this.selectNonEmpty, true);proto.compact = dc(this, this.compact, true);proto.empty = dc(this, this.empty, true);proto.nonEmpty = dc(this, this.nonEmpty, true);proto.numerize = dc(this, this.numerize, true);proto.sum = dc(this, this.sum, true);proto.stringify = dc(this, this.stringify, true);proto.print = dc(this, this.print, true);}};ArtJs.$A = ArtJs.ArrayUtils.arrify;
ArtJs.ClassUtils = com.arthwood.utils.ClassUtils = {init: function() {this.eachInstanceMethodDC = ArtJs.$DC(this, this.eachInstanceMethod);this.eachClassMethodDC = ArtJs.$DC(this, this.eachClassMethod);ArtJs.$E = ArtJs.$DC(this, this.extend);},extend: function(base, constr, instanceMethods, classMethods) {var builder = function() {var callee = arguments.callee;var c = callee.constr;var b = callee.base;var args = ArtJs.$A(arguments);callee.self = this;c.$super = ArtJs.$DC(callee.self, b);c.apply(this, args);};builder.prototype = new base();builder.prototype.constructor = builder;builder.base = base;builder.constr = constr;this.builder = builder;ArtJs.ObjectUtils.eachPair(instanceMethods, this.eachInstanceMethodDC);ArtJs.ObjectUtils.eachPair(classMethods, this.eachClassMethodDC);return builder;},eachInstanceMethod: function(k, v) {var b = this.builder;this.defineOverride(k, v, b.prototype, b.base.prototype[k])},eachClassMethod: function(k, v) {var b = this.builder;var base = b.base;this.defineOverride(k, v, b, base[k])},defineOverride: function(k, v, proto, overriden) {if (overriden) {var wrapper = function() {var callee = arguments.callee;callee.override.$super = ArtJs.$DC(this, callee.overriden);return callee.override.apply(this, ArtJs.$A(arguments));};wrapper.overriden = overriden;wrapper.override = v;wrapper.name = k;proto[k] = wrapper;}else {proto[k] = v;}}};ArtJs.ClassUtils.init();
ArtJs.StringUtils = com.arthwood.utils.StringUtils = {init: function() {this.parseJsonValueDC = ArtJs.$DC(this, this.parseJsonValue);},first: function(str) {return str.substr(0, 1);},last: function(str) {return str.substr(str.length - 1, 1);},strip: function(str) {return str.replace(/\s/g, '');},blank: function(str) {return (str == null) || this.empty(str);},empty: function(str) {return this.strip(str) == '';},nullifyEmpty: function(str) {return this.empty(str) ? null : str;},toS: function(str) {return str || '';},countPattern: function(str, pattern) {return str.match(pattern, 'g').length;},align: function(str, n, char, left) {var zeros = this.getMultiPattern(char, n - str.length);return left ? str + zeros : zeros + str;},getMultiPattern: function (pattern, n) {var str = '';while (n-- > 0) {str += pattern;}return str;},formatPrice: function(price) {var parts = price.toString().split('.');var integer = parts[0];var decimal = parts[1];return integer + '.' + (decimal ? this.addZeros(decimal, 2, true) : '00');},addZeros: function(str, n, left) {return this.align(str, n, '0', left);},truncate: function(text, length, end) {return text.substr(0, length) + ((text.length > length)? (end || '...') : '');},singularOrPlural: function(text, n) {return text + ((n == 1) ? '' : 's');},capitalize: function(str) {return ArtJs.ArrayUtils.map(str.split(' '), this.capitalizeWord).join(' ');},capitalizeWord: function(str) {return str.charAt(0).toUpperCase() + str.substr(1);},capitalizeUnderscored: function(str) {return this.stripSpaces(this.capitalize(str.replace('_', ' ')));},trim: function(str) {return str.replace(/^\s+/, '').replace(/\s+$/, '');},sub: function(str, i, j) {var n = str.length;var jZero = (j == 0);str += str;i = i % n;j = j % n;if (i < 0) i += n;if (j < 0) j += n;if (jZero) j = n;if (j < i) j += n;return str.substring(i, j);},toJson: function(str) {return ArtJs.ObjectUtils.mapValue(eval('(' + str + ')'), this.parseJsonValueDC);},parseJsonValue: function(i) {return (typeof(i) == 'string' && this.first(i) == '{' && this.last(i) == '}') ? this.toJson(i) : i;},doInjection: function() {var proto = String.prototype;var dc = ArtJs.$DC;proto.first = dc(this, this.first, true);proto.last = dc(this, this.last, true);proto.stripSpaces = dc(this, this.stripSpaces, true);proto.stripTabs = dc(this, this.stripTabs, true);proto.stripNewLines = dc(this, this.stripNewLines, true);proto.strip = dc(this, this.strip, true);proto.blank = dc(this, this.blank, true);proto.empty = dc(this, this.empty, true);proto.nullifyEmpty = dc(this, this.nullifyEmpty, true);proto.toS = dc(this, this.toS, true);proto.countPattern = dc(this, this.countPattern, true);proto.align = dc(this, this.align, true);proto.getMultiPattern = dc(this, this.getMultiPattern, true);proto.truncate = dc(this, this.truncate, true);proto.singularOrPlural = dc(this, this.singularOrPlural, false);proto.capitalize = dc(this, this.capitalize, true);proto.capitalizeWord = dc(this, this.capitalizeWord, true);proto.capitalizeUnderscored = dc(this, this.capitalizeUnderscored, true);proto.trim = dc(this, this.trim, true);proto.sub = dc(this, this.sub, true);proto.toJson = dc(this, this.toJson, true);}};
ArtJs.DateUtils = com.arthwood.utils.DateUtils = {monthDaysNum: function(date) {var d = new Date(date);d.setMonth(d.getMonth() + 1);d.setDate(0);return d.getDate();},firstDate: function(date) {var d = new Date(date);d.setDate(1);return d;},firstDay: function(date) {return this.firstDate(date).getDay();},toHMS: function(date, separator) {var su = ArtJs.StringUtils;separator = separator || ':';return su.addZeros(date.getHours().toString(), 2) +separator + su.addZeros(date.getMinutes().toString(), 2) +separator + su.addZeros(date.getSeconds().toString(), 2);},toYMD: function(date, separator) {var su = ArtJs.StringUtils;separator = separator || '/';return date.getFullYear()+ separator + su.addZeros((date.getMonth() + 1).toString(), 2)+ separator + su.addZeros(date.getDate().toString(), 2);},toDMY: function(date, separator) {separator = separator || '/';var ymd = this.toYMD(date, separator);var arr = ymd.split(separator);arr.reverse();return arr.join(separator);},fromDMY: function(str, separator) {separator = separator || '/';var arr = str.split(separator);var au = ArtJs.ArrayUtils;return new Date(parseInt(au.third(arr), 10), parseInt(au.second(arr), 10) - 1, parseInt(au.first(arr), 10));},minutesToHM: function(minutes, separator) {separator = separator || ':';return Math.floor(minutes / 60) + separator + ArtJs.StringUtils.addZeros((minutes % 60).toString(), 2);},hmToMinutes: function(hm, separator) {separator = separator || ':';var arr = hm.split(separator);return 60*parseInt(arr[0], 10) + parseInt(arr[1], 10);},secondsToMS: function(s, separator) {var seconds = s % 60;var minutes = (s - seconds) / 60;var su = ArtJs.StringUtils;separator = separator || ':';return su.addZeros(minutes.toString(), 2) + separator + su.addZeros(seconds.toString(), 2);},msToSeconds: function(ms, separator) {separator = separator || ':';var arr = ms.split(separator);return 60*parseInt(arr[0], 10) + parseInt(arr[1], 10);},secondsToHMS: function(s, separator) {var seconds = s % 60;var minutes = (s - seconds) / 60;separator = (separator || ':');return this.minutesToHM(minutes, separator) + separator + ArtJs.StringUtils.addZeros(seconds.toString(), 2);},/*** Overrides ObjectUtils.copy if injected.*/copy: function(date) {return new Date(date);},getDateShifted: function (date, days) {var dateCopy = this.copy(date);dateCopy.setDate(date.getDate() + days);return dateCopy;},stripDayTime: function(date) {return new Date(date.getFullYear(), date.getMonth(), date.getDate());},doInjection: function() {var proto = Date.prototype;var dc = ArtJs.$DC;proto.monthDaysNum = dc(this, this.monthDaysNum, true);proto.firstDay = dc(this, this.firstDay, true);proto.toHMS = dc(this, this.toHMS, true);proto.toYMD = dc(this, this.toYMD, true);proto.toDMY = dc(this, this.toDMY, true);proto.minutesToHM = dc(this, this.minutesToHM, false);proto.hmToMinutes = dc(this, this.hmToMinutes, false);proto.secondsToMS = dc(this, this.secondsToMS, false);proto.copy = dc(this, this.copy, true);proto.getDateShifted = dc(this, this.getDateShifted, true);proto.stripDayTime = dc(this, this.stripDayTime, true);}};
ArtJs.ElementUtils = com.arthwood.utils.ElementUtils = {HIDDEN_ELEMENTS: [],DEFAULT_DISPLAY: '',MAIN_OBJ_RE: /^\w+/,SUB_OBJ_RE: /\[\w+\]/g,SIZE_STYLE_RE: /^(\d+)px$/,init: function() {this.getContentDC = ArtJs.$DC(this, this.getContent);this.detectHiddenElementDC = ArtJs.$DC(this, this.detectHiddenElement);this.isElementDC = ArtJs.$DC(this, this.isElement);this.serializeInjectDC = ArtJs.$DC(this, this.serializeInject);this.mapSubDC = ArtJs.$DC(this, this.mapSub);this.selectCheckedDC = ArtJs.$DC(this, this.selectChecked);this.mapAttributeDC = ArtJs.$DC(this, this.mapAttribute);this.showDC = ArtJs.$DC(this, this.show);this.hideDC = ArtJs.$DC(this, this.hide);this.isHiddenDC = ArtJs.$DC(this, this.isHidden);},show: function(e) {var hidden = this.getHidden(e);ArtJs.ArrayUtils.removeItem(this.HIDDEN_ELEMENTS, hidden);var display = hidden && hidden.display || e.style.display;e.style.display = (display == 'none') ? this.DEFAULT_DISPLAY : display;},hide: function(e) {var hidden = this.getHidden(e);if (!hidden) {this.HIDDEN_ELEMENTS.push({element: e, display: e.style.display});e.style.display = 'none';}},toggle: function(e) {this.setVisible(e, this.isHidden(e));},setVisible: function(e, v) {v ? this.show(e) : this.hide(e);},isHidden: function(e) {var hidden = this.getHidden(e);return hidden || e.style.display == 'none';},getHidden: function(e) {this.detectHiddenElementDC.delegate.args = [e];return ArtJs.ArrayUtils.detect(this.HIDDEN_ELEMENTS, this.detectHiddenElementDC);},detectHiddenElement: function(i, e) {return i.element == e;},setAlpha: function(e, v) {e.style.opacity = v;},getAlpha: function(e) {return e.style.opacity;},getSize: function(e, real) {return this.getBounds(e, real).getSize();},getBounds: function(e, real, withoutScroll) {var toggle = real && this.isHidden(e);toggle && this.show(e);var b = e.getBoundingClientRect();var layout = new ArtJs.Rectangle(b.left, b.top, b.right, b.bottom);!withoutScroll && layout.moveBy(this.getScrollPosition());toggle && this.hide(e);return layout;},setWidth: function(e, w) {e.style.width = w + 'px';},setHeight: function(e, h) {e.style.height = h + 'px';},getStyle: function(e, prop) {return getComputedStyle(e, null).getPropertyValue(prop);},setStyle: function(e, prop, v) {e.style[prop] = v;},getSizeStyle: function(e, prop) {return this.getSizeStyleValue(this.getStyle(e, prop));},getSizeStyleValue: function(value) {var v = value.match(this.SIZE_STYLE_RE);return v && Number(v[1]) || 0;},getPadding: function(e) {return new ArtJs.Rectangle(this.getSizeStyle(e, 'padding-left'),this.getSizeStyle(e, 'padding-top'),this.getSizeStyle(e, 'padding-right'),this.getSizeStyle(e, 'padding-bottom'))},elements: function(e) {return this.filterElements(ArtJs.$A(e.childNodes));},filterElements: function(items) {return ArtJs.ArrayUtils.select(items, this.isElementDC);},isElement: function(e) {return e.nodeType == 1;},remove: function(e) {e.parentNode.removeChild(e);},parent: function(e) {return e.parentNode;},firstElement: function(e) {return ArtJs.ArrayUtils.first(this.elements(e));},lastElement: function(e) {return ArtJs.ArrayUtils.last(this.elements(e));},prev: function(e) {var result = e;do {result = result.previousSibling;}while (result && !this.isElement(result));return result;},next: function(e) {var result = e;do {result = result.nextSibling;}while (result && !this.isElement(result));return result;},clone: function(e, deep) {return e.cloneNode(deep);},putAtBottom: function(e, ref) {return ref.appendChild(this.clone(e, true));},putAtTop: function(e, ref) {var first = ArtJs.ArrayUtils.first(this.children(ref));return first ? this.putBefore(e, first) : this.putAtBottom(e, ref);},putAfter: function(e, ref) {var next = this.next(ref);return next ? this.putBefore(e, next) : this.putAtBottom(e, this.parent(ref));},putBefore: function(e, ref) {return this.parent(ref).insertBefore(e, ref);},replace: function(e, ref, clone) {var parent = this.parent(ref);var idx = this.elements(parent).indexOf(ref);clone && (e = this.clone(e, true));parent.replaceChild(e, ref);return this.elements(parent)[idx];},center: function(e) {this.setPosition(e, this.getCenteredPosition(e));},centerH: function(e) {var pos = this.getCenteredPosition(e);this.setX(e, pos.x);},centerV: function(e) {var pos = this.getCenteredPosition(e);this.setY(e, pos.y);},getCenteredPosition: function(e) {return this.getWindowSize().sub(this.getSize(e)).times(0.5).add(this.getScrollPosition());},getDocumentSize: function() {var doc = window.document;return new ArtJs.Point(doc.width, doc.height);},getWindowSize: function() {return new ArtJs.Point(window.innerWidth, window.innerHeight);},setPosition: function(e, p) {this.setX(e, p.x);this.setY(e, p.y);},getPosition: function(e, withoutScroll) {return this.getBounds(e, false, withoutScroll).getLeftTop();},getScrollPosition: function() {return new ArtJs.Point(window.scrollX, window.scrollY);},setX: function(e, v) {e.style.left = v + 'px';},setY: function(e, v) {e.style.top = v + 'px';},enable: function(e) {e.removeAttribute('disabled');},disable: function(e) {e.setAttribute('disabled', 'disabled');},setEnabled: function(e, enabled) {enabled ? this.enable(e) : this.disable(e);},serialize: function(e) {var s = ArtJs.Selector;var au = ArtJs.ArrayUtils;var textfields = s.down(e, 'input[type=text]');var checkboxes = au.select(s.down(e, 'input[type=checkbox]'), this.selectCheckedDC);var radios = au.select(s.down(e, 'input[type=radio]'), this.selectCheckedDC);var selects = s.down(e, 'select');var textareas = s.down(e, 'textarea');var hiddenfields = s.down(e, 'input[type=hidden]');var inputs = au.flatten([textfields, checkboxes, radios, selects, textareas, hiddenfields]);var result = au.inject(inputs, {}, this.serializeInjectDC);return result;},selectChecked: function(i) {return i.checked;},serializeInject: function(mem, i, idx) {var name = i.name;var value = i.value;var main = ArtJs.ArrayUtils.first(name.match(this.MAIN_OBJ_RE));var subobjectMatches = name.match(this.SUB_OBJ_RE);var props = subobjectMatches && ArtJs.ArrayUtils.map(ArtJs.$A(subobjectMatches), this.mapSubDC) || [];props.unshift(main);var obj = mem;var n = props.length - 1;var k, prop;for (k = 0; k < n; k++) {prop = props[k];(obj[prop] instanceof Object) || (obj[prop] = {});obj = obj[prop];}obj[props[k]] = value;return mem;},mapSub: function(i, idx) {return ArtJs.StringUtils.sub(i, 1, -1);},getContent: function(e) {return e.innerHTML;},setContent: function(e, v) {e.innerHTML = v;},hasClass: function(e, className) {return ArtJs.ArrayUtils.include(this.getClasses(e), className);},getClasses: function(e) {return e.className.split(' ');},setClass: function(e, className, add) {add ? this.addClass(e, className) : this.removeClass(e, className);},addClass: function(e, className) {var classes = this.getClasses(e);if (!this.hasClass(e, className)) {classes.push(className);e.className = classes.join(' ');}},removeClass: function(e, className) {var classes = this.getClasses(e);if (this.hasClass(e, className)) {ArtJs.ArrayUtils.removeItem(classes, className);e.className = classes.join(' ');}},toggleClass: function(e, className) {this.setClass(e, className, !this.hasClass(e, className));},getAttributes: function(e) {return ArtJs.ObjectUtils.fromArray(ArtJs.ArrayUtils.map(ArtJs.$A(e.attributes), this.mapAttributeDC));},mapAttribute: function(i) {return [i.name, i.value];},doInjection: function() {var proto = Element.prototype;var dc = ArtJs.$DC;var insert = this.insert;proto.getContent = dc(this, this.getContent, true);proto.setContent = dc(this, this.setContent, true);proto.show = dc(this, this.show, true);proto.hide = dc(this, this.hide, true);proto.toggle = dc(this, this.toggle, true);proto.setVisible = dc(this, this.setVisible, true);proto.isHidden = dc(this, this.isHidden, true);proto.setAlpha = dc(this, this.setAlpha, true);proto.getAlpha = dc(this, this.getAlpha, true);proto.getSize = dc(this, this.getSize, true);proto.getBounds = dc(this, this.getBounds, true);proto.setWidth = dc(this, this.setWidth, true);proto.setHeight = dc(this, this.setHeight, true);proto.getStyle = dc(this, this.getStyle, true);proto.setStyle = dc(this, this.setStyle, true);proto.getPadding = dc(this, this.getPadding, true);proto.elements = dc(this, this.elements, true);proto.isElement = dc(this, this.isElement, true);proto.remove = dc(this, this.remove, true);proto.parent = dc(this, this.parent, true);proto.firstElement = dc(this, this.firstElement, true);proto.lastElement = dc(this, this.lastElement, true);proto.prev = dc(this, this.prev, true);proto.next = dc(this, this.next, true);proto.clone = dc(this, this.clone, true);proto.putAtBottom = dc(this, this.putAtBottom, true);proto.putAtTop = dc(this, this.putAtTop, true);proto.putAfter = dc(this, this.putAfter, true);proto.putBefore = dc(this, this.putBefore, true);proto.replace = dc(this, this.replace, true);proto.getPosition = dc(this, this.getPosition, true);proto.setPosition = dc(this, this.setPosition, true);proto.setX = dc(this, this.setX, true);proto.setY = dc(this, this.setY, true);proto.center = dc(this, this.center, true);proto.centerH = dc(this, this.centerH, true);proto.centerV = dc(this, this.centerV, true);proto.enable = dc(this, this.enable, true);proto.disable = dc(this, this.disable, true);proto.setEnabled = dc(this, this.setEnabled, true);proto.serialize = dc(this, this.serialize, true);proto.hasClass = dc(this, this.hasClass, true);proto.getClasses = dc(this, this.getClasses, true);proto.addClass = dc(this, this.addClass, true);proto.removeClass = dc(this, this.removeClass, true);proto.toggleClass = dc(this, this.toggleClass, true);proto.setClass = dc(this, this.setClass, true);proto.getAttributes = dc(this, this.getAttributes, true);}};
ArtJs.EventUtils = com.arthwood.utils.EventUtils = {edge: function(targets) {var t = targets.origin;var ct = targets.current;var rt = targets.related;var s = ArtJs.Selector;return (t == ct) && !s.descendantOf(rt, ct) || s.descendantOf(t, ct) && !s.selfOrDescendant(rt, ct);},doInjection: function() {var proto = Event.prototype;var dc = ArtJs.$DC;proto.edge = dc(this, this.edge, true);}};
ArtJs.Locator = com.arthwood.modules.Locator = {init: function(object) {object.instances = new Array();ArtJs.ObjectUtils.extend(object, this.extensions);},extensions: {find: function(i) {this.found.identifier = i;return ArtJs.ArrayUtils.detect(this.instances, this.found);},found: function(i) {return i.getIdentifier() == arguments.callee.identifier;}}};
ArtJs.DelegateCollection = com.arthwood.events.DelegateCollection = function(delegates) {this.delegates = delegates || new Array();this.delegateToResultDC = ArtJs.$DC(this, this.delegateToResult, false);};ArtJs.DelegateCollection.prototype = {invoke: function() {this.delegateToResultDC.delegate.args = ArtJs.$A(arguments);return ArtJs.ArrayUtils.map(this.delegates, this.delegateToResultDC);},add: function(delegate) {this.delegates.push(delegate);},removeAt: function(i) {ArtJs.ArrayUtils.removeAt(this.delegates, i);},remove: function(delegate) {ArtJs.ArrayUtils.removeItem(this.delegates, delegate);},clear: function() {this.delegates.splice(0);},getLength: function() {return this.delegates.length;},delegateToResult: function(delegate, idx) {return delegate.invoke.apply(delegate, ArtJs.$A(arguments, 2));}};
ArtJs.CustomEvent = com.arthwood.events.CustomEvent = function(name) {this.name = name;this.collection = new ArtJs.DelegateCollection();};ArtJs.CustomEvent.prototype = {fire: function() {return this.collection.invoke.apply(this.collection, ArtJs.$A(arguments));},add: function(delegate) {this.collection.add(delegate);},remove: function(delegate) {this.collection.remove(delegate);},removeAll: function() {this.collection.clear();},getLength: function() {return this.collection.getLength();}};
ArtJs.MouseController = com.arthwood.events.MouseController = function(e) {this.onOver = new ArtJs.CustomEvent('MouseController::onOver');this.onOut = new ArtJs.CustomEvent('MouseController::onOut');e.addEventListener('mouseover', ArtJs.$DC(this, this._onOver), false);e.addEventListener('mouseout', ArtJs.$DC(this, this._onOut), false);this.element = e;this.over = false;arguments.callee.instances.push(this);};ArtJs.MouseController.prototype = {_onOver: function(e) {if (ArtJs.EventUtils.edge(this.getTargets(e, true)) && !this.over) {this.over = true;this.onOver.fire(e, this);}},_onOut: function(e) {if (ArtJs.EventUtils.edge(this.getTargets(e, false)) && this.over) {this.over = false;this.onOut.fire(e, this);}},getTargets: function(e, over) {return {origin: e.target, current: e.currentTarget, related: e.relatedTarget};},getIdentifier: function() {return this.element;}};ArtJs.Locator.init(ArtJs.MouseController);
ArtJs.Point = com.arthwood.math.Point = function(x, y) {this.x = x;this.y = y;};ArtJs.Point.prototype = {getLength: function() {return Math.sqrt(this.x * this.x + this.y * this.y);},dot: function(p) {return (this.x * p.x + this.y * p.y);},add: function(p) {return new ArtJs.Point(this.x + p.x, this.y + p.y);},sub: function(p) {return this.add(p.getReversed());},getReversed: function() {return this.times(-1);},reverseX: function() {this.x = - this.x;return this;},reverseY: function() {this.y = - this.y;return this;},transpose: function() {var temp = this.x;this.x = this.y;this.y = temp;return this;},getTransposed: function() {return new ArtJs.Point(this.y, this.x);},reverse: function() {this.reverseX();this.reverseY();return this;},times: function(k) {return new ArtJs.Point(k * this.x, k * this.y);},toString: function() {return '[' + this.x + ', ' + this.y + ']';}};
ArtJs.Rectangle = com.arthwood.math.Rectangle = function(left, top, right, bottom) {this.left = left;this.top = top;this.right = right;this.bottom = bottom;};ArtJs.Rectangle.prototype = {getWidth: function() {return this.right - this.left;},getHeight: function() {return this.bottom - this.top;},getArea: function() {return this.getWidth() * this.getHeight();},getLeftTop: function() {return new ArtJs.Point(this.left, this.top);},getRightTop: function() {return new ArtJs.Point(this.right, this.top);},getRightBottom: function() {return new ArtJs.Point(this.right, this.bottom);},getLeftBottom: function() {return new ArtJs.Point(this.left, this.bottom);},getSize: function() {return new ArtJs.Point(this.getWidth(), this.getHeight());},moveBy: function(p) {this.left += p.x;this.top += p.y;this.right += p.x;this.bottom += p.y;}}; 
ArtJs.ElementBuilder = com.arthwood.dom.ElementBuilder = function(name, attributes, value, empty) {this.name = name;this.attributes = attributes;this.value = value;this.empty = Boolean(empty);};ArtJs.ElementBuilder.prototype = {toString: function() {var attributes = ArtJs.ObjectUtils.empty(this.attributes) ? '' : (' ' + this.attributesString() + ' ');var part;if (this.value) {part = '>' + this.value + '</' + this.name + '>';}else {if (this.empty) {part = '/>';}else {part = '></' + this.name + '>';}}return '<' + this.name + attributes + part;},getElement: function() {var e = document.createElement(this.name);var sa = ArtJs.ElementBuilder.setAttribute;sa.e = e;ArtJs.ObjectUtils.eachPair(this.attributes, sa);!this.empty && (e.innerHTML = this.value);return e;},attributesString: function() {return ArtJs.ArrayUtils.map(ArtJs.ObjectUtils.toArray(this.attributes),ArtJs.ElementBuilder.attributePairToStringDC).join(' ');}};ArtJs.ObjectUtils.extend(ArtJs.ElementBuilder, {init: function() {ArtJs.$B = ArtJs.$DC(this, this.build);ArtJs.$P = ArtJs.$DC(this, this.parse);ArtJs.$C = ArtJs.$DC(this, this.create);this.attributePairToStringDC = ArtJs.$DC(this, this.attributePairToString);},getElement: function(i) {return arguments.callee.element;},getCollection: function(n, element) {this.getElement.element = element;return ArtJs.ArrayUtils.build(n, this.getElement).join('');},setAttribute: function(k, v) {arguments.callee.e.setAttribute(k, v);},attributePairToString: function(arr) {var key = this.translateKey(arr[0]);var value = arr[1];return key + '="' + value + '"';},translateKey: function(k) {var result;switch (k) {case 'className':result = 'class';break;default:result = k;}return result;},build: function(name, attributes, value, empty) {return new this(name, attributes, value, empty);},parse: function(str) {var node = document.createElement('div');node.innerHTML = str;return node.firstChild;},create: function(name, attributes, value, empty) {return this.parse(this.build(name, attributes, value, empty));}});ArtJs.ElementBuilder.init();
ArtJs.Selector = com.arthwood.dom.Selector = {tagRE: /^\w+/gi,classesRE: /\.\w+/gi,idRE: /#\w+/i,attrsRE: /\[.*\]/gi,init: function() {this.filterFamilyDC = ArtJs.$DC(this, this.filterFamily);this.candidateFamilyMapDC = ArtJs.$DC(this, this.candidateFamilyMap);this.getFamilyDescendantDC = ArtJs.$DC(this, this.getFamilyDescendant);this.attrToArrayDC = ArtJs.$DC(this, this.attrToArray);this.filterByAttributesDC = ArtJs.$DC(this, this.filterByAttributes);this.getSignatureDC = ArtJs.$DC(this, this.getSignature);ArtJs.$ = ArtJs.$DC(this, this.getElementById);ArtJs.$$ = ArtJs.$DC(this, this.getElements);ArtJs.$down = ArtJs.$DC(this, this.down);ArtJs.$up = ArtJs.$DC(this, this.up);},down: function(element, path) {return this.getElements(path, element);},up: function(element, path) {if (!path) return element.parentNode;var signature = this.getSignature(path);var family = this.getFamily(element);var j = 1;var n = family.length;var ok;do {ok = this.checkNode(family[j++], signature);}while (!ok && j < n);return ok ? family[j - 1] : null;},getElements: function(path, root) {var items = path.split(' ');var au = ArtJs.ArrayUtils;var signatures = au.map(items, this.getSignatureDC);var signature = au.last(signatures);var candidates = this.getElementsBySignature(signature);this.candidateFamilyMapDC.delegate.args = [root];var families = au.selectNonEmpty(au.map(candidates, this.candidateFamilyMapDC));this.filterFamilyDC.delegate.args = [signatures];var filteredFamilies = au.select(families, this.filterFamilyDC);return au.map(filteredFamilies, this.getFamilyDescendantDC);},candidateFamilyMap: function(i, idx, root) {return this.getFamily(i, root);},getFamily: function(e, root) {var family = [];while (e) {family.push(e);e = e.parentNode;}return family.slice(0, family.indexOf(root || document.body) + 1);},descendantOf: function(e, root) {var family = this.getFamily(e, root);return !ArtJs.ArrayUtils.empty(family) && family.length > 1;},selfOrDescendant: function(e, root) {return e == root || this.descendantOf(e, root);},filterFamily: function(family, signatures) {var i = signatures.length - 1;var j = 1;var n = family.length;var signature;var ok;if (n == 1) return true;var immediateParent = false;while (i--) {signature = signatures[i];var immediateParentTag = (signature == '>');if (!immediateParentTag) {do {ok = this.checkNode(family[j++], signature);}while (!ok && !immediateParent && j < n);if (!ok) return false;}immediateParent = immediateParentTag;}return true;},checkNode: function(node, signature) {var tag = signature.tag;var id = signature.id;var classes = signature.classes;var attributes = signature.attributes;var au = ArtJs.ArrayUtils;var ou = ArtJs.ObjectUtils;return (!tag || (node.tagName.toLowerCase() == tag))&& (!id || node.id == id)&& (au.empty(classes) || au.includeAll(node.className.split(' '), classes))&& (ou.empty(attributes) || ou.includeAll(node.attributes, attributes));},getSignature: function(selector) {return (selector == '>')? selector: {tag: this.getTag(selector), id: this.getId(selector), classes: this.getClasses(selector),attributes: this.getAttributes(selector)};},getFamilyDescendant: function(i) {return ArtJs.ArrayUtils.first(i);},getElementsBySignature: function(signature) {var au = ArtJs.ArrayUtils;var id = signature.id;var tag = signature.tag;var classes = signature.classes;var attributes = signature.attributes;var elements = [];if (id) {var elementById = this.getElementById(id);if (elementById) {elements.push(elementById);}else {return [];}}if (tag) {var elementsByTag = this.getElementsByTagName(tag);if (au.empty(elementsByTag)) {return [];}else {/* no id given */if (au.empty(elements)) {elements = elementsByTag;}else {elements = au.intersection([elements, elementsByTag]);if (au.empty(elements)) {return [];}}}}if (!au.empty(classes)) {var elementsByClass = this.getElementsByClassName(classes);if (au.empty(elementsByClass)) {return [];}if (au.empty(elements)) {elements = elementsByClass;}else {elements = au.intersection([elements, elementsByClass]);if (au.empty(elements)) {return [];}}}this.filterByAttributesDC.delegate.args = [attributes];return au.compact(au.select(elements, this.filterByAttributesDC));},filterByAttributes: function(i, attributes) {return ArtJs.ObjectUtils.includeAll(ArtJs.ElementUtils.getAttributes(i), attributes);},getTag: function(selector) {var matches = selector.match(this.tagRE);return matches && ArtJs.ArrayUtils.first(matches);},getId: function(selector) {var match = ArtJs.ArrayUtils.first(this.match(selector, this.idRE));return match && this.stripIdSelector(match);},getClasses: function(selector) {return ArtJs.ArrayUtils.map(this.match(selector, this.classesRE), this.stripClassSelector);},getAttributes: function(selector) {var au = ArtJs.ArrayUtils;var matches = au.map(this.match(selector, this.attrsRE), this.stripAttributeSelector);var arr = au.map(matches[0] && matches[0].split(',') || [], this.attrToArrayDC);return ArtJs.ObjectUtils.fromArray(arr);},match: function(str, re) {var matches = str.match(re);return matches && ArtJs.$A(matches) || [];},attrToArray: function(i) {return i.split('=');},stripIdSelector: function(selector) {return selector.slice(1);},stripClassSelector: function(selector) {return selector.slice(1);},stripAttributeSelector: function(selector) {return selector.slice(1).slice(0, selector.length - 2);},getElementById: function(id) {return document.getElementById(id);},getElementsByClassName: function(selector) {return ArtJs.$A(document.getElementsByClassName(selector));},getElementsByTagName: function(tagName) {return ArtJs.$A(document.getElementsByTagName(tagName));},doInjection: function() {var proto = Element.prototype;var dc = ArtJs.$DC;proto.up = dc(this, this.up, true);proto.down = dc(this, this.down, true);proto.getFamily = dc(this, this.getFamily, true);proto.descendantOf = dc(this, this.descendantOf, true);proto.selfOrDescendant = dc(this, this.selfOrDescendant, true);}};
ArtJs.Clock = com.arthwood.events.Clock = function(interval, repeat) {this.interval = interval;this.repeat = repeat;this.intervalId = null;this.counter = 0;this.onChange = new ArtJs.CustomEvent('Clock:onChange');this.onComplete = new ArtJs.CustomEvent('Clock:onComplete');var instances = arguments.callee.instances;this.id = instances.length;instances.push(this);};ArtJs.Clock.prototype = {start: function(now) {this.stop();this.resume(now);},tick: function() {this.counter++;this.onChange.fire(this);if (this.counter == this.repeat) {this.stop();this.onComplete.fire(this);}},stop: function() {clearInterval(this.intervalId);this.intervalId = null;this.counter = 0;},pause: function() {clearInterval(this.intervalId);this.intervalId = null;},resume: function(now) {var code = 'Clock.find(' + this.id + ').tick()';this.intervalId = setInterval(code, this.interval);if (now) {this.tick();}},isRunning: function() {return !(this.intervalId == null);},getIdentifier: function() {return this.id;}};ArtJs.Locator.init(ArtJs.Clock);ArtJs.ObjectUtils.extend(ArtJs.Clock, {fire: function(delegate, delay, repeat) {var clock = new ArtJs.Clock(delegate, delay, repeat);clock.start();return clock;}});
ArtJs.List = com.arthwood.data.List = function(items) {this.items = items || new Array();this.i = 0;this.onChange = new ArtJs.CustomEvent('List::onChange');this.allowDuplicates = true;this.loop = false;};ArtJs.List.prototype = {addItem: function(item, noEvent) {if (this.allowDuplicates || !this.hasItem(item)) {this.items.push(item);!noEvent && this.onChange.fire(this);}return this.getLength();},addItemAt: function(item, position, noEvent) {if (this.allowDuplicates || !this.hasItem(item)) {this.items = ArtJs.ArrayUtils.insertAt(this.items, position, item);!noEvent && this.onChange.fire(this);}return this.getLength();},removeItem: function(item, onlyFirst, noEvent) {ArtJs.ArrayUtils.removeItem(this.items, item, onlyFirst);!noEvent && this.onChange.fire(this);return this.getLength();},removeItemAt: function(position, noEvent) {ArtJs.ArrayUtils.removeAt(this.items, position);!noEvent && this.onChange.fire(this);return this.getLength();},removeAll: function(noEvent) {this.items.splice(0);!noEvent && this.onChange.fire(this);},getItemAt: function(position) {position = this.loop ? (ArtJs.MathUtils.periodicLimit(position, 0, this.getLength())) : position;return this.items[position];},getItemIndex: function(item) {return this.items.indexOf(item);},moveItem: function(fromIndex, toIndex) {var item = this.getItemAt(fromIndex);this.removeItemAt(fromIndex, true);this.addItemAt(item, toIndex);},getLength: function() {return this.items.length;},getItems: function() {return this.items.concat();},setItems: function(items) {this.items = items;this.onChange.fire(this);},hasItem: function(item) {return ArtJs.ArrayUtils.include(this.items, item);},setPointerAtItem: function(item) {if (!this.hasItem(item)) {ArtJs.p("{List} There is no item " + item + " in List!");return;}this.setPointer(this.getItemIndex(item));},reset: function() {this.i = 0;},getPointer: function() {return this.i;},setPointer: function(i) {this.i = i;},decrease: function() {this.i--;},increase: function() {this.i++;},getCurrent: function() {return this.getItemAt(this.i);},getPrevious: function() {return this.getItemAt(this.i - 1);},getNext: function() {return this.getItemAt(this.i + 1);},getFirst: function() {return ArtJs.ArrayUtils.first(this.items);},getLast: function() {return ArtJs.ArrayUtils.last(this.items);},empty: function() {return ArtJs.ArrayUtils.empty(this.items);},isLast: function() {return this.i == (this.getLength() - 1);},toString: function() {return this.items.toString();}};
ArtJs.Queue = com.arthwood.data.Queue = function(data) {this.onChange = new ArtJs.CustomEvent('Queue::onChange');this.list = new ArtJs.List(data);this.list.onChange.add(ArtJs.$D(this, this._onChange));};ArtJs.Queue.prototype = {_onChange: function() {this.onChange.fire(this);},addItem: function(item) {return this.list.addItem(item);},getItem: function() {var item = this.list.getItemAt(0);this.list.removeItemAt(0);return item;},setData: function(data) {this.list = new ArtJs.List(data);},getLength: function() {return this.list.getLength();},empty: function() {return this.list.empty();},toString: function() {return this.list.toString();}};
ArtJs.QueuedClock = com.arthwood.events.QueuedClock = function(interval) {this.busy = false;this.interval = interval;this.queue = new ArtJs.Queue();this.clock = new ArtJs.Clock(this.interval);this.clock.onChange.add(ArtJs.$DC(this, this.start));};ArtJs.QueuedClock.prototype = {start: function() {if (this.queue.empty()) {this.clock.stop();}else {this.queue.getItem().invoke();}},addItem: function(i) {this.queue.addItem(i);if (!this.clock.isRunning()) {this.clock.start(true);}},getLength: function() {return this.queue.getLength();}};
ArtJs.Ajax = com.arthwood.net.Ajax = function(url, data, method) {this.onReadyStateChangeDelegate = ArtJs.$DC(this, this.onReadyStateChange);this.onProgressDelegate = ArtJs.$DC(this, this.onProgress);this.onLoadDelegate = ArtJs.$DC(this, this.onLoad);this.onErrorDelegate = ArtJs.$DC(this, this.onError);this.onSuccess = new ArtJs.CustomEvent('Ajax:onSuccess');this.onFailure = new ArtJs.CustomEvent('Ajax:onFailure');this.onProgress = new ArtJs.CustomEvent('Ajax:onProgress');var methods = ArtJs.Ajax.Methods;this.url = url;this.data = data;this.method = method;this.requestData = data;this.requestMethod = method || methods.GET;if (!ArtJs.ArrayUtils.include(ArtJs.Ajax.SupportedMethods, this.requestMethod)) {this.requestData = this.requestData || {};this.requestData._method = this.requestMethod;this.requestMethod = methods.POST;}this._request = new XMLHttpRequest();this.requestUrl = this.url;if (this.requestData) {this.requestQueryData = ArtJs.ObjectUtils.toQueryString(this.requestData);if (this.requestMethod == methods.GET) {this.requestUrl += ('?' + this.requestQueryData);this.requestQueryData = null;}}this._request.open(this.requestMethod, this.requestUrl, true);this.setRequestHeader('X-Requested-With', 'XMLHttpRequest');this.setRequestHeader('X-ArtJs-Version', ArtJs.VERSION);this.setRequestHeader('Accept', 'text/javascript, text/html, application/xml, text/xml, */*');if (this.requestMethod == methods.POST) {this.setRequestHeader('Content-type', 'application/x-www-form-urlencoded; charset=UTF-8');}this._request.onreadystatechange = this.onReadyStateChangeDelegate;this._request.onprogress = this.onProgressDelegate;this._request.onload = this.onLoadDelegate;this._request.onerror = this.onErrorDelegate;};ArtJs.Ajax.prototype = {request: function() {this._request.send(this.requestQueryData);},abort: function() {this._request.abort();},onReadyStateChange: function(event) {},onProgress: function(event) {var r = event.position / event.totalSize;this.onProgress.fire(this, r);},onLoad: function(event) {this.onSuccess.fire(this);},onError: function(event) {this.onFailure.fire(this);},getReadyState: function() {return this._request.readyState;},getStatus: function() {return this._request.status;},getStatusText: function() {return this._request.statusText;},getResponseText: function() {return this._request.responseText;},getResponseXML: function() {return this._request.responseXML;},setRequestHeader: function(header, value) {return this._request.setRequestHeader(header, value);},getResponseHeader: function(header) {return this._request.getResponseHeader(header);},getAllResponseHeaders: function() {return this._request.getAllResponseHeaders();}};ArtJs.Ajax.Methods = {GET: 'GET',POST: 'POST',PUT: 'PUT',DELETE: 'DELETE'};ArtJs.Ajax.SupportedMethods = [ArtJs.Ajax.Methods.GET, ArtJs.Ajax.Methods.POST];ArtJs.Ajax.ReadyState = {UNINITIALIZED: 0,OPEN: 1,SENT: 2,RECEIVING: 3,LOADED: 4};ArtJs.Ajax.get = ArtJs.$get = function(url, data, onSuccess) {return ArtJs.Ajax.request(url, data, Ajax.Methods.GET, onSuccess);};ArtJs.Ajax.post = ArtJs.$post = function(url, data, onSuccess) {return ArtJs.Ajax.request(url, data, Ajax.Methods.POST, onSuccess);};ArtJs.Ajax.put = ArtJs.$put = function(url, data, onSuccess) {return ArtJs.Ajax.request(url, data, Ajax.Methods.PUT, onSuccess);};ArtJs.Ajax.del = ArtJs.$del = function(url, data, onSuccess) {return ArtJs.Ajax.request(url, data, Ajax.Methods.DELETE, onSuccess);};ArtJs.Ajax.request = function(url, data, method, onSuccess) {var ajax = new Ajax(url, data, method);onSuccess && ajax.onSuccess.add(onSuccess);ajax.request();return ajax;};
ArtJs.ModalBox = com.arthwood.ui.containers.ModalBox = function(element, size, draggable) {this.element = element;this.size = size;this.elementStyle = this.element.style;this.elementStyle.width = this.size.x + 'px';this.elementStyle.height = this.size.y + 'px';this.content = ArtJs.ArrayUtils.first(ArtJs.$down(this.element, '.content'));this.header = ArtJs.ArrayUtils.first(ArtJs.$down(this.element, '.header'));this.onDataLoadD = ArtJs.$D(this, this.onDataLoad);this.onHeaderMouseDownDC = ArtJs.$DC(this, this.onHeaderMouseDown);this.onHeaderMouseDownDC = ArtJs.$DC(this, this.onHeaderMouseDown);this.onHeaderMouseUpDC = ArtJs.$DC(this, this.onHeaderMouseUp);this.onMouseMoveDC = ArtJs.$DC(this, this.onMouseMove);window.addEventListener('resize', ArtJs.$DC(this, this.onResize), false);this.onResize();/* this.setDraggable(draggable); */};ArtJs.ModalBox.prototype = {setTitle: function(title) {this.header.innerHTML = title || '&nbpsp;';},show: function(url) {this.elementStyle.display = 'block';ArtJs.Ajax.get(url, null, this.onDataLoadD);},onDataLoad: function(ajax) {ArtJs.ElementUtils.setContent(this.content, ajax.getResponseText());},onResize: function() {ArtJs.ElementUtils.center(this.element, this.size);},setDraggable: function(draggable) {this.draggable = Boolean(draggable);if (this.draggable) {this.header.addEventListener('mousedown', this.onHeaderMouseDownDC);this.header.addEventListener('mouseup', this.onHeaderMouseUpDC);}else {this.header.removeEventListener('mousedown', this.onHeaderMouseDownDC);this.header.removeEventListener('mouseup', this.onHeaderMouseUpDC);}},onHeaderMouseDown: function(event) {this.shift = new ArtJs.Point();window.addEventListener('mousemove', this.onMouseMoveDC);},onHeaderMouseUp: function(event) {window.removeEventListener('mousemove', this.onMouseMoveDC);},onMouseMove: function(event) {ArtJs.ElementUtils.setPosition(new ArtJs.Point());}};
ArtJs.DatePicker = com.arthwood.ui.DatePicker = function(container, firstDay, yearSpan) {this.items = ArtJs.$$('.datepicker');this.onImgDC = ArtJs.$DC(this, this.onImg);ArtJs.ArrayUtils.each(this.items, ArtJs.$DC(this, this.initField));this.calendar = new ArtJs.Calendar(container, firstDay, yearSpan);};ArtJs.DatePicker.prototype = {initField: function(item) {var input = ArtJs.ArrayUtils.first(ArtJs.Selector.down(item, 'input'));var img = ArtJs.ElementUtils.putAfter(ArtJs.$C('img', {src: '/images/datepicker/cal.gif', alt: 'calendar_icon', className: 'datepicker'}), input);input.editable = false;img.onclick = this.onImgDC;},onImg: function(e) {var img = e.currentTarget;var imgRT = ArtJs.ElementUtils.getBounds(img).getRightTop();var position = imgRT.add(new ArtJs.Point(1, 1));if (this.calendar.isHidden()) {this.calendar.show(ArtJs.ElementUtils.prev(img), position);}else {this.calendar.hide();}return false;}};ArtJs.Calendar = com.arthwood.ui.Calendar = function(container, firstDay, yearSpan) {this.buildYearSpanDC = ArtJs.$DC(this, this.buildYearSpan);this.setYearSpan(yearSpan);var eb = ArtJs.ElementBuilder;var au = ArtJs.ArrayUtils;var s = ArtJs.Selector;var imgPrev = ArtJs.$B('img', {src: '/images/datepicker/prev.gif', alt: 'prev'});var imgNext = ArtJs.$B('img', {src: '/images/datepicker/next.gif', alt: 'next'});var aPrev = ArtJs.$B('a', {href: '#'}, imgPrev);var aNext = ArtJs.$B('a', {href: '#'}, imgNext);var selectYearOptions = au.map(this.years, arguments.callee.yearToOption).join('');var selectYear = ArtJs.$B('select', {id: 'date_year', name: 'date[year]'}, selectYearOptions);var selectMonthOptions = au.map(ArtJs.Calendar.MONTHS, arguments.callee.monthToOption).join('');var selectMonth = ArtJs.$B('select', {id: 'date_month', name: 'date[month]'}, selectMonthOptions);var nav = ArtJs.$B('div', {className: 'nav'}, aPrev + selectMonth + selectYear + aNext);var headElement = ArtJs.$B('th', null, '&nbsp;');var headRow = ArtJs.$B('tr', null, eb.getCollection(7, headElement));var cellElement = ArtJs.$B('td', null, '&nbsp;');var row = ArtJs.$B('tr', null, eb.getCollection(7, cellElement));var rows = eb.getCollection(5, row);var table = ArtJs.$B('table', null, headRow + rows);var element = ArtJs.$B('div', {className: 'datepicker_calendar', style: 'display: none'}, nav + table);ArtJs.ElementUtils.putAtBottom(ArtJs.$P(element), container);this.element = ArtJs.$$('.datepicker_calendar').first();var arrows = s.down(this.element, '.nav a');this.prevMonth = arrows[0];this.nextMonth = arrows[1];this.prevMonth.onclick = ArtJs.$DC(this, this.onPrevMonth);this.nextMonth.onclick = ArtJs.$DC(this, this.onNextMonth);var selects = s.down(this.element, '.nav select');this.monthSelect = selects[0];this.yearSelect = selects[1];this.monthSelect.onchange = ArtJs.$DC(this, this.onMonthSelect);this.yearSelect.onchange = ArtJs.$DC(this, this.onYearSelect);this.headers = s.down(this.element, 'th');this.rows = s.down(this.element, 'tr').slice(1);this.items = s.down(this.element, 'td');this.updateHeaderDC = ArtJs.$DC(this, this.updateHeader);this.updateItemDC = ArtJs.$DC(this, this.updateItem);this.onItemDC = ArtJs.$DC(this, this.onItem);this.updateRowVisibilityDC = ArtJs.$DC(this, this.updateRowVisibility);au.each(this.items, ArtJs.$DC(this, this.initItem));this.field = null;this.firstDay = firstDay || 0;this.date = new Date();this.update();};ArtJs.ObjectUtils.extend(ArtJs.Calendar, {MONTHS: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October','November', 'December'],DAYS: ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'],WEEKEND_DAYS: [6, 0],SEPARATOR: '-',VALID_CELL_BACKGROUND : 'none',WEEKEND_CELL_BACKGROUND : '#CFFFDF',INVALID_CELL_BACKGROUND : "url(/images/datepicker/backstripes.gif)",monthToOption: function(i, idx) {return new ArtJs.ElementBuilder('option', {value: idx + 1}, i);},yearToOption: function(i, idx) {return new ArtJs.ElementBuilder('option', {value: i}, i);}});ArtJs.Calendar.prototype = {show: function(field, position) {this.field = field;var value = this.field.value;this.date = ArtJs.StringUtils.empty(value) ? new Date() : ArtJs.DateUtils.fromDMY(value, ArtJs.Calendar.SEPARATOR);this.update();ArtJs.ElementUtils.setPosition(this.element, position);ArtJs.ElementUtils.show(this.element);},hide: function() {this.field = null;ArtJs.ElementUtils.hide(this.element);},isHidden: function() {return ArtJs.ElementUtils.isHidden(this.element);},update: function() {var au = ArtJs.ArrayUtils;var du = ArtJs.DateUtils;var mu = ArtJs.MathUtils;var monthFirstDate = du.firstDate(this.date);var monthFirstDay = monthFirstDate.getDay();var monthDaysNum = du.monthDaysNum(this.date);this.startIndex = mu.periodicLimit(monthFirstDay - this.firstDay, 0, 7);this.rowsNum = mu.stairs(this.startIndex + monthDaysNum - 1, 0, 7) + 1;this.monthSelect.value = this.date.getMonth() + 1;this.yearSelect.value = this.date.getFullYear();au.eachPair(this.rows, this.updateRowVisibilityDC);au.eachPair(this.headers, this.updateHeaderDC);au.eachPair(this.items, this.updateItemDC);},updateRowVisibility: function(idx, row) {ArtJs.ElementUtils.setVisible(row, idx < this.rowsNum);},updateHeader: function(idx, header) {var index = ArtJs.MathUtils.periodicLimit(this.firstDay + idx, 0, 7);ArtJs.ElementUtils.setContent(header, ArtJs.Calendar.DAYS[index]);},updateItem: function(idx, item) {var day = new Date(this.date);day.setDate(idx - this.startIndex + 1);var value = day.getDate();var valid = (day.getMonth() == this.date.getMonth());var weekend = ArtJs.ArrayUtils.include(ArtJs.Calendar.WEEKEND_DAYS, (idx + this.firstDay) % 7);item.style.background = valid? (weekend ? ArtJs.Calendar.WEEKEND_CELL_BACKGROUND : ArtJs.Calendar.VALID_CELL_BACKGROUND): ArtJs.Calendar.INVALID_CELL_BACKGROUND;item.className = (value == this.date.getDate()) ? 'selected' : '';ArtJs.ElementUtils.setClass(item, 'invalid', !valid);ArtJs.ElementUtils.setContent(item, value);},initItem: function(item) {item.onclick = this.onItemDC;},onItem: function(e) {var item = e.currentTarget;var value = ArtJs.ElementUtils.getContent(item);var valid = !ArtJs.ElementUtils.hasClass(item, 'invalid');if (valid) {this.date.setDate(parseInt(value));this.update();this.field.value = ArtJs.DateUtils.toDMY(this.date, ArtJs.Calendar.SEPARATOR);this.hide();}return false;},onPrevMonth: function(e) {return this.onMonth(-1);},onNextMonth: function(e) {return this.onMonth(1);},onMonth: function(v) {this.date.setMonth(this.date.getMonth() + v);this.monthSelect.value = this.date.getMonth() + 1;this.yearSelect.value = this.date.getFullYear();this.update();return false;},onMonthSelect: function(e) {var select = e.currentTarget;this.date.setMonth(parseInt(select.value) - 1);this.update();return false;},onYearSelect: function(e) {var select = e.currentTarget;this.date.setFullYear(parseInt(select.value));this.update();return false;},setYearSpan: function(span) {this.yearSpan = span;this.years = ArtJs.ArrayUtils.build(this.yearSpan.y - this.yearSpan.x + 1, this.buildYearSpanDC);},buildYearSpan: function(i) {return this.yearSpan.x + i;}};
ArtJs.Flash = com.arthwood.ui.Flash = function(element, path, delay) {this.element = element;this.image = ArtJs.ArrayUtils.first(ArtJs.Selector.down(this.element, 'img'));this.span = ArtJs.ArrayUtils.first(ArtJs.Selector.down(this.element, 'span'));this.path = path;this.fade = new ArtJs.Fade(this.element, - 0.05);this.fade.onComplete.add(ArtJs.$D(this, this.onFadeComplete));this.element.onclick = ArtJs.$DC(this, this.onFlashClick);this.delay = (delay || 6) * 1000;var visible = !ArtJs.StringUtils.empty(ArtJs.ElementUtils.getContent(this.span));var instances = arguments.callee.instances;this.id = instances.length;instances.push(this);visible && this.display();};ArtJs.Flash.prototype = {show: function(type, message) {this.image.src = this.path + '/' + type + '.png';this.span.innerHTML = message;this.display();},display: function() {var eu = ArtJs.ElementUtils;this.fade.stop();this.clearDelay();eu.show(this.element);eu.centerH(this.element);eu.setY(this.element, 0.2 * ArtJs.ElementUtils.getWindowSize().y);eu.setAlpha(this.element, 1);var code = 'Flash.find(' + this.id + ').hide()';this.intervalId = setInterval(code, this.delay);},hide: function() {this.clearDelay();this.fade.setFinalState();this.fade.start();},clearDelay: function() {clearInterval(this.intervalId);this.intervalId = null;},onFadeComplete: function() {ArtJs.ElementUtils.hide(this.element);this.span.innerHTML = null;this.image.src = this.path + '/blank.png';},onFlashClick: function() {if (this.intervalId) {this.hide();}return false;},getIdentifier: function() {return this.id;}};ArtJs.Locator.init(ArtJs.Flash);
com.arthwood.tween.Base = function(e, delta, interval, eventName) {var defaults = arguments.callee.DEFAULTS;this.element = e;this.on = true;this.p = 0;this.setDelta(delta || defaults.delta);this.interval = interval;this.clock = new ArtJs.Clock(this.interval || defaults.interval);this.clock.onChange.add(ArtJs.$D(this, this.onTick));this.onComplete = new ArtJs.CustomEvent(eventName);};ArtJs.ObjectUtils.extend(com.arthwood.tween.Base, {DEFAULTS: {delta: 0.05, interval: 20}});com.arthwood.tween.Base.prototype = {start: function() {this.beforeStart();this.clock.start();},stop: function() {this.clock.stop();},onTick: function(clock) {this.p += this.delta;if (this.on && this.p < 1 || !this.on && this.p > 0) {this.update();}else {this.clock.stop();this.p = Number(this.on);this.update();this.afterFinish();this.onComplete.fire(this);}},toggle: function() {this.setDelta(- this.delta);},setDelta: function(d) {this.delta = d;this.on = Boolean(ArtJs.MathUtils.sgn(this.delta) + 1);},getDelta: function() {return this.delta;},update: function() {},isRunning: function() {this.clock.isRunning();},beforeStart: function() {this.update();},afterFinish: function() {},setInitialState: function() {this.p = 0;},setFinalState: function() {this.p = 1;},inInitialState: function() {return this.p == 0;},inFinalState: function() {return this.p == 1;},getIdentifier: function() {return this.element;}};
ArtJs.Fade = com.arthwood.tween.Fade = ArtJs.$E(com.arthwood.tween.Base, function(e, delta, interval) {arguments.callee.$super(e, delta, interval, 'Fade:onComplete');ArtJs.Reveal.instances.push(this);}, {update: function() {arguments.callee.$super();ArtJs.ElementUtils.setAlpha(this.element, this.p);}});ArtJs.Locator.init(ArtJs.Fade);ArtJs.ObjectUtils.extend(ArtJs.Fade, {doInjection: function() {var proto = Element.prototype;proto.fade = function(delta, interval) {return new ArtJs.Fade(this, delta, interval);};}});
ArtJs.Reveal = com.arthwood.tween.Reveal = ArtJs.$E(com.arthwood.tween.Base, function(e, delta, interval) {arguments.callee.$super(e, delta, interval, 'Reveal:onComplete');var eu = ArtJs.ElementUtils;this.heightWithPadding = eu.getSize(e, true).y;this.padding = eu.getPadding(e);this.height = this.heightWithPadding - (this.padding.top + this.padding.bottom);ArtJs.Reveal.instances.push(this);}, {update: function() {arguments.callee.$super();var mu = ArtJs.MathUtils;var height = this.height;var h = this.p * this.heightWithPadding;var pt = this.padding.top;var pb = this.padding.bottom;var s = this.element.style;var p1 = Math.round(mu.limit(h, 0, pt));var p2 = Math.round(mu.limit(h - pt, 0, height));var p3 = Math.round(mu.limit(h - height - pt, 0, pb));s.paddingTop = p1 + 'px';s.height = p2 + 'px';s.paddingBottom = p3 + 'px';},beforeStart: function() {arguments.callee.$super();this.inInitialState() && this.on && ArtJs.ElementUtils.show(this.element);},afterFinish: function() {arguments.callee.$super();this.inInitialState() && !this.on && ArtJs.ElementUtils.hide(this.element);}});ArtJs.Locator.init(ArtJs.Reveal);ArtJs.ObjectUtils.extend(ArtJs.Reveal, {doInjection: function() {var proto = Element.prototype;proto.reveal = function(delta, interval) {return new ArtJs.Reveal(this, delta, interval);};}});
ArtJs.ArrayUtils.init();ArtJs.ObjectUtils.init();ArtJs.StringUtils.init();ArtJs.ElementUtils.init();ArtJs.Selector.init();
